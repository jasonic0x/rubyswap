(this["webpackJsonpoort-frontend"]=this["webpackJsonpoort-frontend"]||[]).push([[19],{1102:function(e,t,n){"use strict";n.r(t);var r,c,a,i,o=n(10),s=n(5),d=n.n(s),l=n(9),b=n(15),j=n(7),u=n(0),p=n(2),h=n(67),x=n(90),m=n(717),O=n.n(m),f=n(990),_=n.n(f),k=n(125),g=n(244),v=n(111),y=n(228),T=n(13),D=n(30),w=n(333),C=n(240),P=n(16),B=n(330),S=n(52),q=n(992),I=n.n(q),L=(n(991),n(1)),Y=function(e){var t=e.inputProps,n=void 0===t?{}:t,r=Object(S.a)(e,["inputProps"]);return Object(L.jsx)(I.a,Object(l.a)({customInput:Object(L.jsx)(p.R,Object(l.a)({},n)),portalId:"reactDatePicker",dateFormat:"PPP"},r))},E=n(8),M=n(4),A=(M.e.div(r||(r=Object(E.a)(["\n  .react-datepicker-wrapper,\n  .react-datepicker__input-container {\n    display: block;\n  }\n\n  .react-datepicker {\n    background: ",";\n    border-color: ",";\n    color: ",";\n    font-family: 'Kanit', sans-serif;\n  }\n\n  .react-datepicker__header {\n    background: ",";\n    border-color: ",";\n  }\n\n  .react-datepicker__current-month,\n  .react-datepicker-time__header,\n  .react-datepicker-year-header,\n  .react-datepicker__day-name,\n  .react-datepicker__day,\n  .react-datepicker__time-name {\n    color: ",";\n  }\n\n  .react-datepicker__day:hover,\n  .react-datepicker__month-text:hover,\n  .react-datepicker__quarter-text:hover,\n  .react-datepicker__year-text:hover {\n    background-color: ",";\n  }\n\n  .react-datepicker-popper[data-placement^='bottom'] .react-datepicker__triangle::before,\n  .react-datepicker-popper[data-placement^='bottom'] .react-datepicker__triangle::after {\n    border-bottom-color: ",";\n  }\n\n  .react-datepicker__day--selected,\n  .react-datepicker__day--in-selecting-range,\n  .react-datepicker__day--in-range,\n  .react-datepicker__month-text--selected,\n  .react-datepicker__month-text--in-selecting-range,\n  .react-datepicker__month-text--in-range,\n  .react-datepicker__quarter-text--selected,\n  .react-datepicker__quarter-text--in-selecting-range,\n  .react-datepicker__quarter-text--in-range,\n  .react-datepicker__year-text--selected,\n  .react-datepicker__year-text--in-selecting-range,\n  .react-datepicker__year-text--in-range {\n    background-color: ",";\n  }\n\n  .react-datepicker__day--selected:hover,\n  .react-datepicker__day--in-selecting-range:hover,\n  .react-datepicker__day--in-range:hover,\n  .react-datepicker__month-text--selected:hover,\n  .react-datepicker__month-text--in-selecting-range:hover,\n  .react-datepicker__month-text--in-range:hover,\n  .react-datepicker__quarter-text--selected:hover,\n  .react-datepicker__quarter-text--in-selecting-range:hover,\n  .react-datepicker__quarter-text--in-range:hover,\n  .react-datepicker__year-text--selected:hover,\n  .react-datepicker__year-text--in-selecting-range:hover,\n  .react-datepicker__year-text--in-range:hover {\n    background-color: ",";\n  }\n\n  .react-datepicker__day--keyboard-selected,\n  .react-datepicker__month-text--keyboard-selected,\n  .react-datepicker__quarter-text--keyboard-selected,\n  .react-datepicker__year-text--keyboard-selected {\n    background-color: ",";\n    color: #ffffff;\n  }\n\n  .react-datepicker__day--keyboard-selected:hover,\n  .react-datepicker__month-text--keyboard-selected:hover,\n  .react-datepicker__quarter-text--keyboard-selected:hover,\n  .react-datepicker__year-text--keyboard-selected:hover {\n    background-color: ",";\n    color: #ffffff;\n  }\n\n  .react-datepicker__time-container,\n  .react-datepicker__time-container .react-datepicker__time .react-datepicker__time-box {\n    width: 120px;\n  }\n\n  .react-datepicker__header--time {\n    padding: 8px;\n  }\n\n  .react-datepicker__time-container\n    .react-datepicker__time\n    .react-datepicker__time-box\n    ul.react-datepicker__time-list\n    li.react-datepicker__time-list-item {\n    height: auto;\n    padding: 8px;\n  }\n"])),(function(e){return e.theme.card.background}),(function(e){return e.theme.colors.cardBorder}),(function(e){return e.theme.colors.text}),(function(e){return e.theme.colors.input}),(function(e){return e.theme.colors.cardBorder}),(function(e){return e.theme.colors.text}),(function(e){return e.theme.colors.cardBorder}),(function(e){return e.theme.colors.cardBorder}),(function(e){return e.theme.colors.primary}),(function(e){return e.theme.colors.primaryBright}),(function(e){return e.theme.colors.secondary}),(function(e){return e.theme.colors.secondary})),function(e){var t=Object(P.b)().t;return Object(L.jsx)(Y,Object(l.a)({showTimeSelect:!0,showTimeSelectOnly:!0,timeIntervals:15,timeCaption:t("Time"),dateFormat:"ppp"},e))}),R=n(154),F=n(850),z=n(112),H=n(704),N=n(812),J=M.e.label(c||(c=Object(E.a)(["\n  color: #313240;\n  display: block;\n  font-weight: 600;\n  margin-bottom: 8px;\n"]))),V=Object(M.e)(J)(a||(a=Object(E.a)(["\n  font-size: 20px;\n"]))),K=Object(M.e)(J)(i||(i=Object(E.a)(["\n  font-size: 12px;\n  text-transform: uppercase;\n"]))),U=function(e){var t=e.children;return Object(L.jsx)(p.wb,{color:"failure",mb:"4px",children:t})},W=function(e){var t=e.errors;return Object(L.jsx)(p.l,{mt:"8px",children:t.map((function(e){return Object(L.jsx)(U,{children:e},e)}))})},G=n(34),Q=n(220),X=n.n(Q),Z=function(e){var t=e.onRemove,n=e.onTextInput,r=Object(S.a)(e,["onRemove","onTextInput"]),c=Object(u.useState)(!1),a=Object(j.a)(c,2),i=a[0],o=a[1],s=Object(u.useState)(!1),d=Object(j.a)(s,2),b=d[0],h=d[1];return Object(L.jsxs)(p.l,{position:"relative",mb:"16px",children:[Object(L.jsx)(p.R,Object(l.a)(Object(l.a)({},r),{},{onChange:function(e){var t=e.currentTarget.value;o(b&&0===t.length),h(!0),n(t)},isWarning:i})),t&&Object(L.jsx)(p.l,{position:"absolute",right:"8px",top:"0px",zIndex:30,children:Object(L.jsx)(p.P,{variant:"text",onClick:t,children:Object(L.jsx)(p.B,{})})})]})},$=function(){return{id:X()(),value:""}},ee=function(e){var t=e.choices,n=e.onChange,r=Object(P.b)().t,c=t.filter((function(e){return e.value.length>0})).length>=2;return Object(L.jsxs)(p.q,{children:[Object(L.jsx)(p.t,{children:Object(L.jsx)(p.N,{as:"h3",scale:"md",children:r("Choices")})}),Object(L.jsxs)(p.r,{children:[t.map((function(e,c){var a=e.id,i=e.value;return Object(L.jsx)(Z,{scale:"lg",onTextInput:function(e){var r=Object(G.a)(t),c=r.findIndex((function(e){return e.id===a}));r[c].value=e,n(r)},placeholder:r("Input choice text"),value:i,onRemove:c>1?function(){n(t.filter((function(e){return e.id!==a})))}:void 0},a)})),Object(L.jsx)(p.m,{width:"100%",type:"button",onClick:function(){n([].concat(Object(G.a)(t),[$()]))},disabled:!c,children:r("Add Choice")})]})]})},te=n(771),ne=n(1091),re=n(1094),ce=function(e,t){if(!Object(te.default)(e)||!Object(te.default)(t))return null;var n=Object(ne.default)(e,"yyyy-MM-dd"),r=Object(ne.default)(t,"HH:mm:ss");return Object(re.default)("".concat(n,"T").concat(r)).getTime()/1e3},ae=n(706),ie=n(157),oe=n(815),se=n(814),de=function(e){var t=e.block,n=e.onDismiss,r=Object(P.b)().t,c=Object(u.useState)(!0),a=Object(j.a)(c,2),i=a[0],o=a[1],s=Object(oe.a)(t,i),d=s.isLoading,l=s.total,b=s.cakeBalance,h=s.cakeVaultBalance,x=s.cakePoolBalance,m=s.poolsBalance,O=s.cakeBnbLpBalance,f=Object(ie.a)().theme;return Object(L.jsx)(p.ab,{title:r("Voting Power"),onDismiss:function(){o(!1),n()},headerBackground:f.colors.gradients.cardHeader,children:Object(L.jsx)(p.l,{mb:"24px",width:"320px",children:d?Object(L.jsx)(p.L,{height:"450px",alignItems:"center",justifyContent:"center",children:Object(L.jsx)(p.pb,{size:80})}):Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)(se.a,{total:l,cakeBalance:b,cakeVaultBalance:h,cakePoolBalance:x,poolsBalance:m,cakeBnbLpBalance:O}),Object(L.jsx)(p.m,{variant:"secondary",onClick:n,width:"100%",mt:"16px",children:r("Close")})]})})})},le=Object(u.lazy)((function(){return Promise.all([n.e(8),n.e(12)]).then(n.bind(null,1098))}));t.default=function(){var e=Object(u.useState)({name:"",body:"",choices:O()(2).map($),startDate:null,startTime:null,endDate:null,endTime:null,snapshot:0}),t=Object(j.a)(e,2),n=t[0],r=t[1],c=Object(u.useState)(!1),a=Object(j.a)(c,2),i=a[0],s=a[1],m=Object(u.useState)({}),f=Object(j.a)(m,2),S=f[0],q=f[1],I=Object(P.b)().t,E=Object(x.c)().account,M=Object(g.b)(),J=Object(h.g)().push,U=Object(T.a)().library,Q=Object(y.a)(),X=Q.toastSuccess,Z=Q.toastError,ne=Object(p.Pb)(Object(L.jsx)(de,{block:n.snapshot})),re=Object(j.a)(ne,1)[0],ie=n.name,oe=n.body,se=n.choices,be=n.startDate,je=n.startTime,ue=n.endDate,pe=n.endTime,he=n.snapshot,xe=function(e,t){var n=e.name,r=e.body,c=e.choices,a=e.startDate,i=e.startTime,o=e.endDate,s=e.endTime,d=e.snapshot,l={};n||(l.name=[t("%field% is required",{field:"Title"})]),r||(l.body=[t("%field% is required",{field:"Body"})]),c.length<2&&(l.choices=[t("Please create a minimum of %num% choices",{num:2})]);var b=c.some((function(e){return!e.value}));2===c.length&&b&&(l.choices=Array.isArray(l.choices)?[].concat(Object(G.a)(l.choices),[t("Choices must not be empty")]):l.choices=[t("Choices must not be empty")]),Object(te.default)(a)||(l.startDate=[t("Please select a valid date")]),Object(te.default)(i)||(l.startTime=[t("Please select a valid time")]),Object(te.default)(o)||(l.endDate=[t("Please select a valid date")]),Object(te.default)(s)||(l.endTime=[t("Please select a valid time")]);var j=ce(a,i);return ce(o,s)<j&&(l.endDate=Array.isArray(l.endDate)?[].concat(Object(G.a)(l.endDate),[t("End date must be after the start date")]):l.endDate=[t("End date must be after the start date")]),0===d&&(l.snapshot=[t("Invalid snapshot")]),l}(n,I),me=function(){var e=Object(b.a)(d.a.mark((function e(t){var n,r,c,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,s(!0),n=JSON.stringify(Object(l.a)(Object(l.a)({},Object(H.e)()),{},{type:v.c.PROPOSAL,payload:{name:ie,body:oe,snapshot:he,start:ce(be,je),end:ce(ue,pe),choices:se.filter((function(e){return e.value})).map((function(e){return e.value})),metadata:Object(H.d)(),type:"single-choice"}})),e.next=6,Object(C.c)(U,E,n);case 6:if(!(r=e.sent)){e.next=16;break}return c={address:E,msg:n,sig:r},e.next=11,Object(H.i)(c);case 11:a=e.sent,J("/voting/proposal/".concat(a.ipfsHash)),X(I("Proposal created!")),e.next=17;break;case 16:Z(I("Error"),I("Unable to sign payload"));case 17:e.next=24;break;case 19:e.prev=19,e.t0=e.catch(1),Z(I("Error"),(null===e.t0||void 0===e.t0?void 0:e.t0.message)||(null===e.t0||void 0===e.t0?void 0:e.t0.error)),console.error(e.t0),s(!1);case 24:case"end":return e.stop()}}),e,null,[[1,19]])})));return function(t){return e.apply(this,arguments)}}(),Oe=function(e,t){r((function(n){return Object(l.a)(Object(l.a)({},n),{},Object(o.a)({},e,t))})),q((function(t){return Object(l.a)(Object(l.a)({},t),{},Object(o.a)({},e,!0))}))},fe=function(e){return function(t){Oe(e,t)}},_e=Object(u.useMemo)((function(){return{hideIcons:E&&ae.a.includes(E.toLowerCase())?[]:["guide","fullscreen","preview","side-by-side","image"]}}),[E]);return Object(u.useEffect)((function(){M>0&&r((function(e){return Object(l.a)(Object(l.a)({},e),{},{snapshot:M})}))}),[M,r]),Object(L.jsxs)(B.a,{children:[Object(L.jsx)(z.a,{}),Object(L.jsx)(k.b,{children:Object(L.jsx)(k.a,{children:Object(L.jsx)("form",{onSubmit:me,children:Object(L.jsxs)(N.a,{children:[Object(L.jsxs)(p.l,{pt:"24px",children:[Object(L.jsxs)(p.l,{mb:"24px",children:[Object(L.jsx)(V,{color:"#313240",htmlFor:"name",children:I("Title")}),Object(L.jsx)(p.R,{id:"name",name:"name",value:ie,scale:"lg",onChange:function(e){var t=e.currentTarget,n=t.name,r=t.value;Oe(n,r)},required:!0}),xe.name&&S.name&&Object(L.jsx)(W,{errors:xe.name})]}),Object(L.jsxs)(p.l,{mb:"24px",children:[Object(L.jsx)(V,{color:"#313240",htmlFor:"body",children:I("Content")}),Object(L.jsx)(p.wb,{color:"textSubtle",mb:"8px",children:I("Tip: write in Markdown!")}),Object(L.jsx)(le,{id:"body",name:"body",onTextChange:function(e){Oe("body",e)},value:oe,options:_e,required:!0}),xe.body&&S.body&&Object(L.jsx)(W,{errors:xe.body})]}),oe&&Object(L.jsx)(p.l,{mb:"24px",children:Object(L.jsxs)(p.q,{children:[Object(L.jsx)(p.t,{children:Object(L.jsx)(p.N,{as:"h3",scale:"md",children:I("Preview")})}),Object(L.jsx)(p.r,{p:"0",px:"24px",children:Object(L.jsx)(F.a,{children:oe})})]})}),Object(L.jsx)(ee,{choices:se,onChange:function(e){Oe("choices",e)}}),xe.choices&&S.choices&&Object(L.jsx)(W,{errors:xe.choices})]}),Object(L.jsx)(p.l,{pt:"24px",children:Object(L.jsxs)(p.q,{children:[Object(L.jsx)(p.t,{children:Object(L.jsx)(p.N,{as:"h3",scale:"md",children:I("Actions")})}),Object(L.jsxs)(p.r,{children:[Object(L.jsxs)(p.l,{mb:"24px",children:[Object(L.jsx)(K,{children:I("Start Date")}),Object(L.jsx)(Y,{name:"startDate",onChange:fe("startDate"),selected:be,placeholderText:"YYYY/MM/DD"}),xe.startDate&&S.startDate&&Object(L.jsx)(W,{errors:xe.startDate})]}),Object(L.jsxs)(p.l,{mb:"24px",children:[Object(L.jsx)(K,{children:I("Start Time")}),Object(L.jsx)(A,{name:"startTime",onChange:fe("startTime"),selected:je,placeholderText:"00:00"}),xe.startTime&&S.startTime&&Object(L.jsx)(W,{errors:xe.startTime})]}),Object(L.jsxs)(p.l,{mb:"24px",children:[Object(L.jsx)(K,{children:I("End Date")}),Object(L.jsx)(Y,{name:"endDate",onChange:fe("endDate"),selected:ue,placeholderText:"YYYY/MM/DD"}),xe.endDate&&S.endDate&&Object(L.jsx)(W,{errors:xe.endDate})]}),Object(L.jsxs)(p.l,{mb:"24px",children:[Object(L.jsx)(K,{children:I("End Time")}),Object(L.jsx)(A,{name:"endTime",onChange:fe("endTime"),selected:pe,placeholderText:"00:00"}),xe.endTime&&S.endTime&&Object(L.jsx)(W,{errors:xe.endTime})]}),E&&Object(L.jsxs)(p.L,{alignItems:"center",mb:"8px",children:[Object(L.jsx)(p.wb,{color:"textSubtle",mr:"16px",children:I("Creator")}),Object(L.jsx)(p.T,{href:Object(D.e)(E,"address"),children:Object(w.a)(E)})]}),Object(L.jsxs)(p.L,{alignItems:"center",mb:"16px",children:[Object(L.jsx)(p.wb,{color:"textSubtle",mr:"16px",children:I("Snapshot")}),Object(L.jsx)(p.T,{href:Object(D.e)(he,"block"),children:he})]}),E?Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)(p.m,{type:"submit",width:"100%",isLoading:i,endIcon:i?Object(L.jsx)(p.h,{spin:!0,color:"currentColor"}):null,disabled:!_()(xe),mb:"16px",children:I("Publish")}),Object(L.jsxs)(p.wb,{color:"failure",as:"p",mb:"4px",children:[I("You need at least %count% voting power to publish a proposal.",{count:ae.f})," "]}),Object(L.jsx)(p.m,{scale:"sm",type:"button",variant:"text",onClick:re,p:0,children:I("Check voting power")})]}):Object(L.jsx)(R.a,{width:"100%",type:"button"})]})]})})]})})})})]})}}}]);